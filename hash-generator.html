<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hash Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #fff;
            min-height: 100vh;
        }

        .card {
            border: none;
            box-shadow: none;
            min-height: 100vh;
        }

        .hash-display {
            background-color: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 0.5rem;
            padding: 1.25rem;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            word-break: break-all;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            position: relative;
        }

        .hash-display.generated {
            background-color: #e7f1ff;
            border-color: #0d6efd;
        }

        .hash-display .placeholder {
            color: #adb5bd;
            font-style: italic;
        }

        .hash-display .text {
            color: #212529;
            font-weight: 500;
        }

        .settings-panel {
            background-color: #f8f9fa;
            border-radius: 0.5rem;
            padding: 1.25rem;
        }

        .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .setting-controls {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: #fff;
            margin-top: 1rem;
        }

        .upload-area:hover {
            border-color: #adb5bd;
            background-color: #f8f9fa;
        }

        .upload-area.dragover {
            border-color: #0d6efd;
            background-color: #e7f1ff;
        }

        .upload-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            opacity: 0.7;
        }

        input[type="file"] {
            display: none;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .file-badge {
            background-color: #e7f1ff;
            border-left: 3px solid #0d6efd;
            padding: 0.75rem;
            border-radius: 0.25rem;
            margin-top: 0.5rem;
            font-size: 0.875rem;
        }

        .hash-type-badge {
            display: inline-block;
            background-color: #0d6efd;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body p-4 p-md-5">
                        <div class="mx-auto" style="max-width: 800px;">
                        <h1 class="card-title h3 mb-1">Hash Generator</h1>
                        <p class="text-muted mb-4 small">Generate cryptographic hashes from files. All processing happens in your browser.</p>

                        <div class="upload-area mb-3" id="uploadArea">
                            <div class="upload-icon">ðŸ“„</div>
                            <div class="fw-semibold text-primary mb-1">Click to upload or drag and drop</div>
                            <div class="text-muted small">Any file type</div>
                            <input type="file" id="fileInput">
                        </div>

                        <div id="fileInfo"></div>

                        <div class="settings-panel mb-3">
                            <div class="setting-row">
                                <div>
                                    <label class="form-label mb-0 fw-semibold">Hash Algorithm</label>
                                    <div class="text-muted small">Choose hash type</div>
                                </div>
                                <div class="setting-controls">
                                    <select class="form-select" id="hashTypeSelect" style="width: auto;">
                                        <option value="SHA-1">SHA-1</option>
                                        <option value="SHA-256" selected>SHA-256</option>
                                        <option value="SHA-384">SHA-384</option>
                                        <option value="SHA-512">SHA-512</option>
                                        <option value="MD5">MD5</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3 mt-3">
                            <label class="form-label fw-semibold">Hash Output</label>
                            <div class="hash-display" id="hashDisplay">
                                <span class="placeholder">Your hash will appear here</span>
                            </div>
                        </div>

                        <div id="statusArea"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentHash = '';
        let currentFile = null;

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const hashTypeSelect = document.getElementById('hashTypeSelect');
        const hashDisplay = document.getElementById('hashDisplay');
        const generateBtn = document.getElementById('generateBtn');
        const statusArea = document.getElementById('statusArea');

        // Upload area interactions
        uploadArea.addEventListener('click', () => fileInput.click());

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            if (e.dataTransfer.files.length > 0) {
                handleFileSelect(e.dataTransfer.files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileSelect(e.target.files[0]);
            }
        });

        function handleFileSelect(file) {
            currentFile = file;
            
            fileInfo.innerHTML = `
                <div class="file-badge">
                    <strong>ðŸ“Ž File selected:</strong> ${file.name} (${formatFileSize(file.size)})
                </div>
            `;
            
            // Auto-generate hash
            generateHash();
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        // Generate hash on algorithm change
        hashTypeSelect.addEventListener('change', () => {
            if (currentFile) {
                generateHash();
            }
        });

        async function generateHash() {
            if (!currentFile) {
                setStatus('error', 'Please select a file');
                return;
            }
            
            const hashType = hashTypeSelect.value;
            
            try {
                setStatus('processing', `Hashing file with ${hashType}...`);
                const arrayBuffer = await currentFile.arrayBuffer();
                const hash = await computeHash(arrayBuffer, hashType);
                
                currentHash = hash;
                hashDisplay.innerHTML = `
                    <div style="width: 100%;">
                        <div class="hash-type-badge">${hashType}</div>
                        <div class="text" style="cursor: pointer;" onclick="copyHash()" title="Click to copy">${hash}</div>
                    </div>
                `;
                hashDisplay.classList.add('generated');
                setStatus('success', `File hashed successfully with ${hashType}. Click hash to copy.`);
                
            } catch (error) {
                console.error(error);
                setStatus('error', 'Hash generation failed: ' + error.message);
            }
        }

        async function computeHash(data, algorithm) {
            // For MD5, we need a different approach since SubtleCrypto doesn't support it
            if (algorithm === 'MD5') {
                return await computeMD5(data);
            }
            
            const hashBuffer = await crypto.subtle.digest(algorithm, data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        // Simple MD5 implementation
        async function computeMD5(data) {
            const bytes = data instanceof ArrayBuffer ? new Uint8Array(data) : data;
            
            // MD5 implementation
            function md5cycle(x, k) {
                let a = x[0], b = x[1], c = x[2], d = x[3];
                a = ff(a, b, c, d, k[0], 7, -680876936);
                d = ff(d, a, b, c, k[1], 12, -389564586);
                c = ff(c, d, a, b, k[2], 17, 606105819);
                b = ff(b, c, d, a, k[3], 22, -1044525330);
                a = ff(a, b, c, d, k[4], 7, -176418897);
                d = ff(d, a, b, c, k[5], 12, 1200080426);
                c = ff(c, d, a, b, k[6], 17, -1473231341);
                b = ff(b, c, d, a, k[7], 22, -45705983);
                a = ff(a, b, c, d, k[8], 7, 1770035416);
                d = ff(d, a, b, c, k[9], 12, -1958414417);
                c = ff(c, d, a, b, k[10], 17, -42063);
                b = ff(b, c, d, a, k[11], 22, -1990404162);
                a = ff(a, b, c, d, k[12], 7, 1804603682);
                d = ff(d, a, b, c, k[13], 12, -40341101);
                c = ff(c, d, a, b, k[14], 17, -1502002290);
                b = ff(b, c, d, a, k[15], 22, 1236535329);
                a = gg(a, b, c, d, k[1], 5, -165796510);
                d = gg(d, a, b, c, k[6], 9, -1069501632);
                c = gg(c, d, a, b, k[11], 14, 643717713);
                b = gg(b, c, d, a, k[0], 20, -373897302);
                a = gg(a, b, c, d, k[5], 5, -701558691);
                d = gg(d, a, b, c, k[10], 9, 38016083);
                c = gg(c, d, a, b, k[15], 14, -660478335);
                b = gg(b, c, d, a, k[4], 20, -405537848);
                a = gg(a, b, c, d, k[9], 5, 568446438);
                d = gg(d, a, b, c, k[14], 9, -1019803690);
                c = gg(c, d, a, b, k[3], 14, -187363961);
                b = gg(b, c, d, a, k[8], 20, 1163531501);
                a = gg(a, b, c, d, k[13], 5, -1444681467);
                d = gg(d, a, b, c, k[2], 9, -51403784);
                c = gg(c, d, a, b, k[7], 14, 1735328473);
                b = gg(b, c, d, a, k[12], 20, -1926607734);
                a = hh(a, b, c, d, k[5], 4, -378558);
                d = hh(d, a, b, c, k[8], 11, -2022574463);
                c = hh(c, d, a, b, k[11], 16, 1839030562);
                b = hh(b, c, d, a, k[14], 23, -35309556);
                a = hh(a, b, c, d, k[1], 4, -1530992060);
                d = hh(d, a, b, c, k[4], 11, 1272893353);
                c = hh(c, d, a, b, k[7], 16, -155497632);
                b = hh(b, c, d, a, k[10], 23, -1094730640);
                a = hh(a, b, c, d, k[13], 4, 681279174);
                d = hh(d, a, b, c, k[0], 11, -358537222);
                c = hh(c, d, a, b, k[3], 16, -722521979);
                b = hh(b, c, d, a, k[6], 23, 76029189);
                a = hh(a, b, c, d, k[9], 4, -640364487);
                d = hh(d, a, b, c, k[12], 11, -421815835);
                c = hh(c, d, a, b, k[15], 16, 530742520);
                b = hh(b, c, d, a, k[2], 23, -995338651);
                a = ii(a, b, c, d, k[0], 6, -198630844);
                d = ii(d, a, b, c, k[7], 10, 1126891415);
                c = ii(c, d, a, b, k[14], 15, -1416354905);
                b = ii(b, c, d, a, k[5], 21, -57434055);
                a = ii(a, b, c, d, k[12], 6, 1700485571);
                d = ii(d, a, b, c, k[3], 10, -1894986606);
                c = ii(c, d, a, b, k[10], 15, -1051523);
                b = ii(b, c, d, a, k[1], 21, -2054922799);
                a = ii(a, b, c, d, k[8], 6, 1873313359);
                d = ii(d, a, b, c, k[15], 10, -30611744);
                c = ii(c, d, a, b, k[6], 15, -1560198380);
                b = ii(b, c, d, a, k[13], 21, 1309151649);
                a = ii(a, b, c, d, k[4], 6, -145523070);
                d = ii(d, a, b, c, k[11], 10, -1120210379);
                c = ii(c, d, a, b, k[2], 15, 718787259);
                b = ii(b, c, d, a, k[9], 21, -343485551);
                x[0] = add32(a, x[0]);
                x[1] = add32(b, x[1]);
                x[2] = add32(c, x[2]);
                x[3] = add32(d, x[3]);
            }
            
            function cmn(q, a, b, x, s, t) {
                a = add32(add32(a, q), add32(x, t));
                return add32((a << s) | (a >>> (32 - s)), b);
            }
            
            function ff(a, b, c, d, x, s, t) {
                return cmn((b & c) | ((~b) & d), a, b, x, s, t);
            }
            
            function gg(a, b, c, d, x, s, t) {
                return cmn((b & d) | (c & (~d)), a, b, x, s, t);
            }
            
            function hh(a, b, c, d, x, s, t) {
                return cmn(b ^ c ^ d, a, b, x, s, t);
            }
            
            function ii(a, b, c, d, x, s, t) {
                return cmn(c ^ (b | (~d)), a, b, x, s, t);
            }
            
            function add32(a, b) {
                return (a + b) & 0xFFFFFFFF;
            }
            
            function rhex(n) {
                let s = '', j;
                for (j = 0; j < 4; j++) {
                    s += ((n >> (j * 8 + 4)) & 0x0F).toString(16) +
                         ((n >> (j * 8)) & 0x0F).toString(16);
                }
                return s;
            }
            
            // Convert bytes to words
            const n = bytes.length;
            const state = [1732584193, -271733879, -1732584194, 271733878];
            let i;
            
            for (i = 64; i <= bytes.length; i += 64) {
                const block = new Uint32Array(16);
                for (let j = 0; j < 16; j++) {
                    block[j] = bytes[i - 64 + j * 4] |
                              (bytes[i - 64 + j * 4 + 1] << 8) |
                              (bytes[i - 64 + j * 4 + 2] << 16) |
                              (bytes[i - 64 + j * 4 + 3] << 24);
                }
                md5cycle(state, block);
            }
            
            // Handle remaining bytes
            const tail = new Uint8Array(64);
            const rem = bytes.length % 64;
            for (let j = 0; j < rem; j++) {
                tail[j] = bytes[bytes.length - rem + j];
            }
            tail[rem] = 0x80;
            
            if (rem >= 56) {
                const block = new Uint32Array(16);
                for (let j = 0; j < 16; j++) {
                    block[j] = tail[j * 4] |
                              (tail[j * 4 + 1] << 8) |
                              (tail[j * 4 + 2] << 16) |
                              (tail[j * 4 + 3] << 24);
                }
                md5cycle(state, block);
                tail.fill(0);
            }
            
            tail[56] = n * 8;
            tail[57] = (n >>> 29) & 0xFF;
            tail[58] = (n >>> 37) & 0xFF;
            tail[59] = (n >>> 45) & 0xFF;
            tail[60] = (n >>> 53) & 0xFF;
            tail[61] = (n >>> 61) & 0xFF;
            
            const block = new Uint32Array(16);
            for (let j = 0; j < 16; j++) {
                block[j] = tail[j * 4] |
                          (tail[j * 4 + 1] << 8) |
                          (tail[j * 4 + 2] << 16) |
                          (tail[j * 4 + 3] << 24);
            }
            md5cycle(state, block);
            
            return rhex(state[0]) + rhex(state[1]) + rhex(state[2]) + rhex(state[3]);
        }

        async function copyHash() {
            try {
                await navigator.clipboard.writeText(currentHash);
                setStatus('success', 'Hash copied to clipboard!');
            } catch (error) {
                setStatus('error', 'Failed to copy: ' + error.message);
            }
        }

        function setStatus(type, text) {
            const alertClass = type === 'success' ? 'success' : type === 'error' ? 'danger' : 'info';
            statusArea.innerHTML = `<div class="alert alert-${alertClass} mb-3">${text}</div>`;
        }

        console.log('Hash Generator ready');
    </script>
</body>
</html>
